--------------------------------------------------------
--  File created - szombat-április-06-2024   
--------------------------------------------------------
DROP TABLE "WEBSHOP"."REVIEWS" cascade constraints;
DROP TABLE "WEBSHOP"."PRODUCTS" cascade constraints;
DROP TABLE "WEBSHOP"."USERS" cascade constraints;
DROP TABLE "WEBSHOP"."REVIEWS" cascade constraints;
--------------------------------------------------------
--  DDL for Table REVIEWS
--------------------------------------------------------

  CREATE TABLE "WEBSHOP"."REVIEWS" 
   (	"REVIEWID" NUMBER GENERATED BY DEFAULT AS IDENTITY MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 1 CACHE 20 NOORDER  NOCYCLE  NOKEEP  NOSCALE , 
	"USERID" NUMBER, 
	"PRODUCTID" NUMBER, 
	"RATING" NUMBER, 
	"TEXT" CLOB
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" 
 LOB ("TEXT") STORE AS SECUREFILE (
  TABLESPACE "USERS" ENABLE STORAGE IN ROW CHUNK 8192
  NOCACHE LOGGING  NOCOMPRESS  KEEP_DUPLICATES 
  STORAGE(INITIAL 106496 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)) ;
--------------------------------------------------------
--  DDL for Table PRODUCTS
--------------------------------------------------------

  CREATE TABLE "WEBSHOP"."PRODUCTS" 
   (	"PRODUCTID" NUMBER GENERATED BY DEFAULT AS IDENTITY MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 1 CACHE 20 NOORDER  NOCYCLE  NOKEEP  NOSCALE , 
	"PRICE" NUMBER(10,2), 
	"DESCRIPTION" CLOB, 
	"NAME" VARCHAR2(255 BYTE), 
	"CATEGORYID" NUMBER
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" 
 LOB ("DESCRIPTION") STORE AS SECUREFILE (
  TABLESPACE "USERS" ENABLE STORAGE IN ROW CHUNK 8192
  NOCACHE LOGGING  NOCOMPRESS  KEEP_DUPLICATES 
  STORAGE(INITIAL 106496 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)) ;
--------------------------------------------------------
--  DDL for Table USERS
--------------------------------------------------------

  CREATE TABLE "WEBSHOP"."USERS" 
   (	"USERID" NUMBER GENERATED BY DEFAULT AS IDENTITY MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 1 CACHE 20 NOORDER  NOCYCLE  NOKEEP  NOSCALE , 
	"NAME" VARCHAR2(255 BYTE), 
	"EMAIL" VARCHAR2(255 BYTE), 
	"PHONENUMBER" VARCHAR2(20 BYTE), 
	"ISADMIN" CHAR(1 BYTE), 
	"PASSWORDHASH" VARCHAR2(255 BYTE)
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
--------------------------------------------------------
--  DDL for Table REVIEWS
--------------------------------------------------------

  CREATE TABLE "WEBSHOP"."REVIEWS" 
   (	"REVIEWID" NUMBER GENERATED BY DEFAULT AS IDENTITY MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 1 CACHE 20 NOORDER  NOCYCLE  NOKEEP  NOSCALE , 
	"USERID" NUMBER, 
	"PRODUCTID" NUMBER, 
	"RATING" NUMBER, 
	"TEXT" CLOB
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" 
 LOB ("TEXT") STORE AS SECUREFILE (
  TABLESPACE "USERS" ENABLE STORAGE IN ROW CHUNK 8192
  NOCACHE LOGGING  NOCOMPRESS  KEEP_DUPLICATES 
  STORAGE(INITIAL 106496 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)) ;
REM INSERTING into WEBSHOP.REVIEWS
SET DEFINE OFF;
Insert into WEBSHOP.REVIEWS (REVIEWID,USERID,PRODUCTID,RATING) values ('1','1','1','5');
Insert into WEBSHOP.REVIEWS (REVIEWID,USERID,PRODUCTID,RATING) values ('2','2','2','4');
Insert into WEBSHOP.REVIEWS (REVIEWID,USERID,PRODUCTID,RATING) values ('3','3','3','3');
Insert into WEBSHOP.REVIEWS (REVIEWID,USERID,PRODUCTID,RATING) values ('4','4','4','5');
Insert into WEBSHOP.REVIEWS (REVIEWID,USERID,PRODUCTID,RATING) values ('5','5','5','2');
Insert into WEBSHOP.REVIEWS (REVIEWID,USERID,PRODUCTID,RATING) values ('6','6','6','4');
Insert into WEBSHOP.REVIEWS (REVIEWID,USERID,PRODUCTID,RATING) values ('7','7','7','5');
Insert into WEBSHOP.REVIEWS (REVIEWID,USERID,PRODUCTID,RATING) values ('8','8','8','1');
Insert into WEBSHOP.REVIEWS (REVIEWID,USERID,PRODUCTID,RATING) values ('9','9','9','3');
Insert into WEBSHOP.REVIEWS (REVIEWID,USERID,PRODUCTID,RATING) values ('10','10','10','4');
Insert into WEBSHOP.REVIEWS (REVIEWID,USERID,PRODUCTID,RATING) values ('11','11','1','5');
Insert into WEBSHOP.REVIEWS (REVIEWID,USERID,PRODUCTID,RATING) values ('12','12','2','2');
Insert into WEBSHOP.REVIEWS (REVIEWID,USERID,PRODUCTID,RATING) values ('13','13','3','4');
Insert into WEBSHOP.REVIEWS (REVIEWID,USERID,PRODUCTID,RATING) values ('14','14','4','1');
Insert into WEBSHOP.REVIEWS (REVIEWID,USERID,PRODUCTID,RATING) values ('15','15','5','3');
Insert into WEBSHOP.REVIEWS (REVIEWID,USERID,PRODUCTID,RATING) values ('16','16','6','4');
Insert into WEBSHOP.REVIEWS (REVIEWID,USERID,PRODUCTID,RATING) values ('17','17','7','5');
Insert into WEBSHOP.REVIEWS (REVIEWID,USERID,PRODUCTID,RATING) values ('18','18','8','2');
Insert into WEBSHOP.REVIEWS (REVIEWID,USERID,PRODUCTID,RATING) values ('19','19','9','4');
Insert into WEBSHOP.REVIEWS (REVIEWID,USERID,PRODUCTID,RATING) values ('20','20','10','5');
--------------------------------------------------------
--  DDL for Index SYS_C007372
--------------------------------------------------------

  CREATE UNIQUE INDEX "WEBSHOP"."SYS_C007372" ON "WEBSHOP"."REVIEWS" ("REVIEWID") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
--------------------------------------------------------
--  Constraints for Table REVIEWS
--------------------------------------------------------

  ALTER TABLE "WEBSHOP"."REVIEWS" MODIFY ("REVIEWID" NOT NULL ENABLE);
  ALTER TABLE "WEBSHOP"."REVIEWS" ADD CHECK (Rating BETWEEN 1 AND 5) ENABLE;
  ALTER TABLE "WEBSHOP"."REVIEWS" ADD PRIMARY KEY ("REVIEWID")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS"  ENABLE;
--------------------------------------------------------
--  Ref Constraints for Table REVIEWS
--------------------------------------------------------

  ALTER TABLE "WEBSHOP"."REVIEWS" ADD CONSTRAINT "FK_REVIEWS_USERS" FOREIGN KEY ("USERID")
	  REFERENCES "WEBSHOP"."USERS" ("USERID") ON DELETE CASCADE ENABLE;
  ALTER TABLE "WEBSHOP"."REVIEWS" ADD CONSTRAINT "FK_REVIEWS_PRODUCTS" FOREIGN KEY ("PRODUCTID")
	  REFERENCES "WEBSHOP"."PRODUCTS" ("PRODUCTID") ON DELETE CASCADE ENABLE;
